
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Chapter 0: Gental Review on Key Concepts &#8212; Diffusion Models for Statistics</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'chapter0';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Chapter 1: Non-equilibrium Thermodynamics" href="chapter1.html" />
    <link rel="prev" title="Diffusion Models For Statistics" href="intro.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/Astronaut_Riding_a_Horse.jpg" class="logo__image only-light" alt="Diffusion Models for Statistics - Home"/>
    <script>document.write(`<img src="_static/Astronaut_Riding_a_Horse.jpg" class="logo__image only-dark" alt="Diffusion Models for Statistics - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Diffusion Models For Statistics
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Chapter 0: Gental Review on Key Concepts</a></li>
<li class="toctree-l1"><a class="reference internal" href="chapter1.html">Chapter 1: Non-equilibrium Thermodynamics</a></li>
<li class="toctree-l1"><a class="reference internal" href="chapter2.html">Notebooks with MyST Markdown</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks.html">Content with notebooks</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2Fchapter0.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/chapter0.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Chapter 0: Gental Review on Key Concepts</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#probability-distributions">1. <strong>Probability Distributions</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#markov-chains">2. <strong>Markov Chains</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#key-properties">Key Properties:</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#diffusion-process">3. <strong>Diffusion Process</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#score-matching">4. <strong>Score Matching</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#stochastic-processes">5. <strong>Stochastic Processes</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#wiener-process">Wiener Process:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ito-calculus">Ito Calculus:</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#kl-divergence">6. <strong>KL Divergence</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#variational-inference">7. <strong>Variational Inference</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#evidence-lower-bound-elbo">Evidence Lower Bound (ELBO):</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#breakdown-of-the-elbo">Breakdown of the ELBO:</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#monte-carlo-sampling">8. <strong>Monte Carlo Sampling</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#estimating-expectations">Estimating Expectations:</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#remarks">9. Remarks</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="chapter-0-gental-review-on-key-concepts">
<span id="chapter0-0"></span><h1>Chapter 0: Gental Review on Key Concepts<a class="headerlink" href="#chapter-0-gental-review-on-key-concepts" title="Link to this heading">#</a></h1>
<p>Before diving into the fascinating world of diffusion models, let’s have the refresher
of some key concepts in diffusion models, which would be useful later on. Notice that
here we just briefly touch the <a class="reference internal" href="#chapter0-3"><span class="std std-ref"><strong>forward process</strong></span></a> and [<strong>reverse process</strong>]
intuitively.  We’ll have detailed explanation about them in <a class="reference internal" href="#chapter2.0"><span class="xref myst"><strong>Chapter 2</strong></span></a>.
Similarly, <a class="reference internal" href="#chapter0-4"><span class="std std-ref"><strong>score function</strong></span></a> as a commonly used objective function in
diffusion models will be emphasized in following chapters.</p>
<section id="probability-distributions">
<span id="chapter0-1"></span><h2>1. <strong>Probability Distributions</strong><a class="headerlink" href="#probability-distributions" title="Link to this heading">#</a></h2>
<p>Diffusion models are heavily based on probabilistic methods, making an understanding of probability distributions essential. The most important distribution is:</p>
<ul>
<li><p><strong>Gaussian (Normal) Distribution</strong>:</p>
<ul>
<li><p>Used in the noise processes of diffusion models.</p></li>
<li><p>Defined by mean <span class="math notranslate nohighlight">\(\mu\)</span> and variance <span class="math notranslate nohighlight">\(\sigma^2\)</span>, denoted as <span class="math notranslate nohighlight">\( \mathcal{N}(\mu, \sigma^2) \)</span>.</p></li>
<li><p>Probability density function (PDF):</p>
<div class="math notranslate nohighlight">
\[p(x) = \frac{1}{\sqrt{2\pi\sigma^2}} \exp\left(-\frac{(x - \mu)^2}{2\sigma^2}\right).\]</div>
</li>
</ul>
</li>
</ul>
</section>
<section id="markov-chains">
<span id="chapter0-2"></span><h2>2. <strong>Markov Chains</strong><a class="headerlink" href="#markov-chains" title="Link to this heading">#</a></h2>
<p>A <strong>Markov chain</strong> is a type of stochastic process that moves through a series of states, where the probability of transitioning to the next state depends only on the current state (and not on the history of states). This <strong>“memoryless”</strong> property is fundamental in modeling processes such as the noise injection in diffusion models.</p>
<section id="key-properties">
<h3>Key Properties:<a class="headerlink" href="#key-properties" title="Link to this heading">#</a></h3>
<ul>
<li><p><strong>Transition Probability</strong>:</p>
<ul>
<li><p>Describes the probability of moving from one state to another.</p></li>
<li><p>If <span class="math notranslate nohighlight">\(X_t\)</span> is the current state at time <span class="math notranslate nohighlight">\(t\)</span>, then the transition probability is:</p>
<div class="math notranslate nohighlight">
\[P(X_{t+1} = x' | X_t = x) = P(x' | x).\]</div>
</li>
</ul>
</li>
<li><p><strong>Markov Property</strong>:</p>
<ul>
<li><p>Future states depend <u>only on the present state</u>, not past states.</p>
<div class="math notranslate nohighlight">
\[P(X_{t+1} | X_t, X_{t-1}, \dots, X_0) = P(X_{t+1} | X_t)\]</div>
</li>
</ul>
</li>
</ul>
<p>A <strong>stationary distribution</strong> is a probability distribution that remains constant in a Markov chain as it transitions between states. If a Markov chain reaches its stationary distribution, further transitions do not change the overall distribution of states.</p>
</section>
</section>
<section id="diffusion-process">
<span id="chapter0-3"></span><h2>3. <strong>Diffusion Process</strong><a class="headerlink" href="#diffusion-process" title="Link to this heading">#</a></h2>
<p>A diffusion process describes the spread of particles (or probabilities) over time. The <strong>forward process</strong> introduces noise, while the <strong>reverse process</strong> denoises to recover a clear sample:</p>
<ul>
<li><p><strong>Forward Process</strong>:</p>
<div class="math notranslate nohighlight">
\[q(x_t | x_{t-1}) = \mathcal{N}(x_t; \sqrt{\alpha_t} x_{t-1}, (1-\alpha_t)I)\]</div>
<figure class="align-default" id="id2">
<img alt="_images/markov_chain.png" src="_images/markov_chain.png" />
<figcaption>
<p><span class="caption-number">Fig. 1 </span><span class="caption-text">With certain transition probability <span class="math notranslate nohighlight">\(q\)</span>, the <strong>forward process</strong> gradually add noise to the image <span class="math notranslate nohighlight">\(x_0\)</span> since time <span class="math notranslate nohighlight">\(t=0\)</span>, and finally it becomes pure noise <span class="math notranslate nohighlight">\(x_T\)</span> at   time <span class="math notranslate nohighlight">\(T\)</span>.</span><a class="headerlink" href="#id2" title="Link to this image">#</a></p>
</figcaption>
</figure>
</li>
<li><p><strong>Reverse Process</strong>:</p>
<div class="math notranslate nohighlight">
\[p(x_{t-1} | x_t) = \mathcal{N}(x_{t-1}; \mu_\theta(x_t, t), \Sigma_\theta(t))\]</div>
</li>
</ul>
</section>
<section id="score-matching">
<span id="chapter0-4"></span><h2>4. <strong>Score Matching</strong><a class="headerlink" href="#score-matching" title="Link to this heading">#</a></h2>
<p>In diffusion models, score matching helps recover the score function (gradient of log-probability):</p>
<ul>
<li><p><strong>Score Function</strong>:</p>
<div class="math notranslate nohighlight">
\[\nabla_x \log p(x)\]</div>
<p>The score function is used to guide the <strong>reverse process</strong> back to the original data distribution.</p>
</li>
</ul>
</section>
<section id="stochastic-processes">
<span id="chapter0-5"></span><h2>5. <strong>Stochastic Processes</strong><a class="headerlink" href="#stochastic-processes" title="Link to this heading">#</a></h2>
<p>A <strong>stochastic process</strong> describes systems evolving over time under random influences. Important stochastic tools include:</p>
<section id="wiener-process">
<h3>Wiener Process:<a class="headerlink" href="#wiener-process" title="Link to this heading">#</a></h3>
<ul>
<li><p><strong>Wiener Process</strong>, also known as <strong>Brownian motion</strong>, is a continuous-time stochastic process with the following properties:
i. <strong>Initial value</strong>: <span class="math notranslate nohighlight">\(W(0) = 0\)</span>.
ii. <strong>Independent increments</strong>: The increments <span class="math notranslate nohighlight">\(W(t) - W(s)\)</span> are independent for <span class="math notranslate nohighlight">\(t &gt; s\)</span>.
iii. <strong>Normally distributed increments</strong>: For <span class="math notranslate nohighlight">\(t &gt; s\)</span>, the increment <span class="math notranslate nohighlight">\(W(t) - W(s)\)</span> is distributed as <span class="math notranslate nohighlight">\(\mathcal{N}(0, t - s)\)</span>.
iv. <strong>Continuous paths</strong>: The function <span class="math notranslate nohighlight">\(W(t)\)</span> is continuous in <span class="math notranslate nohighlight">\(t\)</span>, though it is non-differentiable at any point.</p></li>
<li><p>The Wiener process is the core building block of <strong>stochastic differential equations (SDEs)</strong>, which are used to model noise in diffusion models.
The Wiener process <span class="math notranslate nohighlight">\(W(t)\)</span> satisfies the stochastic differential equation:</p>
<div class="math notranslate nohighlight">
\[dW(t) = \mathcal{N}(0, dt)\]</div>
</li>
<li><p>This means that over a small time interval <span class="math notranslate nohighlight">\(dt\)</span>, the change in the process is normally distributed with mean zero and variance proportional to <span class="math notranslate nohighlight">\(dt\)</span>.</p></li>
</ul>
</section>
<section id="ito-calculus">
<h3>Ito Calculus:<a class="headerlink" href="#ito-calculus" title="Link to this heading">#</a></h3>
<ul>
<li><p><strong>Ito Calculus</strong> is a branch of stochastic calculus that extends traditional calculus to deal with the randomness introduced by processes like the Wiener process. It is specifically designed to handle stochastic differential equations (SDEs), which are central to diffusion models.</p></li>
<li><p><strong>Ito’s Lemma</strong> is the stochastic calculus counterpart of the chain rule in classical calculus. If <span class="math notranslate nohighlight">\(f\)</span> is a twice-differentiable function and <span class="math notranslate nohighlight">\(X_t\)</span> is a stochastic process described by the SDE:</p>
<div class="math notranslate nohighlight">
\[dX_t = \mu(X_t, t) dt + \sigma(X_t, t) dW_t\]</div>
<p>Then Ito’s Lemma gives the differential for <span class="math notranslate nohighlight">\(f(X_t, t)\)</span>:</p>
<div class="math notranslate nohighlight">
\[df(X_t, t) = \frac{\partial f}{\partial X_t} dX_t + \frac{\partial f}{\partial t} dt + \frac{1}{2} \sigma^2(X_t, t) \frac{\partial^2 f}{\partial X_t^2} dt\]</div>
</li>
<li><p>The <strong>Ito integral</strong> is defined differently from classical Riemann integrals due to the non-differentiability of the Wiener process. For a stochastic process <span class="math notranslate nohighlight">\(X(t)\)</span> and a Wiener process <span class="math notranslate nohighlight">\(W(t)\)</span>, the Ito integral is written as:</p>
<div class="math notranslate nohighlight">
\[\int_0^t X(s) dW(s)\]</div>
<p>This integral represents the cumulative effect of random fluctuations up to time <span class="math notranslate nohighlight">\(t\)</span>, and it is used to solve SDEs.</p>
</li>
<li><p>In the context of diffusion models, the <strong>stochastic differential equations</strong> describe the evolution of the data as it undergoes noise injection or denoising. These equations typically take the form:</p>
<div class="math notranslate nohighlight">
\[dx_t = \mu(x_t, t) dt + \sigma(t) dW_t\]</div>
<p>where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\mu(x_t, t)\)</span> represents the deterministic drift term (direction of movement),</p></li>
<li><p><span class="math notranslate nohighlight">\(\sigma(t)\)</span> represents the volatility or noise intensity,</p></li>
<li><p><span class="math notranslate nohighlight">\(dW_t\)</span> is the Wiener process term that introduces randomness.
In the <strong>reverse process</strong> of diffusion models, solving these SDEs using Ito calculus helps to recover the original data distribution by progressively removing noise.</p></li>
</ul>
</li>
</ul>
</section>
</section>
<section id="kl-divergence">
<span id="id1"></span><h2>6. <strong>KL Divergence</strong><a class="headerlink" href="#kl-divergence" title="Link to this heading">#</a></h2>
<p>The <strong>Kullback-Leibler (KL) Divergence</strong> measures the difference between two probability distributions <span class="math notranslate nohighlight">\(P\)</span> and <span class="math notranslate nohighlight">\(Q\)</span>:</p>
<div class="math notranslate nohighlight">
\[D_{KL}(P || Q) = \int P(x) \log \frac{P(x)}{Q(x)} \, dx\]</div>
<p>KL divergence is often used in diffusion models to minimize the difference between the true distribution and the model distribution.</p>
</section>
<section id="variational-inference">
<span id="chapter0-7"></span><h2>7. <strong>Variational Inference</strong><a class="headerlink" href="#variational-inference" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p><strong>Variational Inference</strong> (VI) is a technique used in probabilistic models to approximate complex, intractable probability distributions with simpler, tractable ones. In diffusion models, VI is crucial for learning the parameters of the reverse process, which transforms noisy data back into clean data. The goal is to approximate the true posterior distribution <span class="math notranslate nohighlight">\(p(x_{1:T} | x_0)\)</span> (i.e., the reverse process) using a variational distribution <span class="math notranslate nohighlight">\(q(x_{1:T} | x_0)\)</span>, which is simpler to compute.</p></li>
</ul>
<section id="evidence-lower-bound-elbo">
<h3>Evidence Lower Bound (ELBO):<a class="headerlink" href="#evidence-lower-bound-elbo" title="Link to this heading">#</a></h3>
<ul>
<li><p>The objective in variational inference is to maximize the <strong>Evidence Lower Bound (ELBO)</strong>, a quantity that provides a lower bound to the likelihood of the observed data. Maximizing the ELBO indirectly helps approximate the true posterior distribution.</p></li>
<li><p>The ELBO is given by:</p>
<div class="math notranslate nohighlight">
\[\mathcal{L} = \mathbb{E}_q \left[ \log p_\theta(x_0 | x_t) - D_{KL}(q(x_{1:T} | x_0) || p_\theta(x_{1:T})), \right]\]</div>
<p>where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(p_\theta(x_0 | x_t)\)</span>: The likelihood of the data given the noisy version at time <span class="math notranslate nohighlight">\(t\)</span>, parameterized by <span class="math notranslate nohighlight">\(\theta\)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\(D_{KL}(q || p)\)</span>: The Kullback-Leibler (KL) divergence between the variational distribution <span class="math notranslate nohighlight">\(q(x_{1:T} | x_0)\)</span> and the model distribution <span class="math notranslate nohighlight">\(p_\theta(x_{1:T})\)</span>, which measures how different these two distributions are.</p></li>
<li><p><span class="math notranslate nohighlight">\(x_0\)</span>: The original (clean) data.</p></li>
<li><p><span class="math notranslate nohighlight">\(x_t\)</span>: The noisy data at time step <span class="math notranslate nohighlight">\(t\)</span>.</p></li>
</ul>
</li>
</ul>
</section>
<section id="breakdown-of-the-elbo">
<h3>Breakdown of the ELBO:<a class="headerlink" href="#breakdown-of-the-elbo" title="Link to this heading">#</a></h3>
<p>i. <strong>Reconstruction Term</strong>:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\log p_\theta(x_0 | x_t)\)</span> encourages the model to generate samples <span class="math notranslate nohighlight">\(x_0\)</span> that closely resemble the original clean data given the noisy data <span class="math notranslate nohighlight">\(x_t\)</span>. It measures how well the model can reconstruct clean data from noisy observations.</p></li>
</ul>
<p>ii. <strong>KL Divergence Term</strong>:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(D_{KL}(q(x_{1:T} | x_0) || p_\theta(x_{1:T}))\)</span> penalizes the difference between the learned reverse process (the variational approximation) and the true posterior distribution. Minimizing this term helps align the learned process with the actual data-generating process.</p></li>
<li><p>In diffusion models, the <strong>forward process</strong> gradually adds noise to data, leading to a tractable Gaussian distribution at the final step. The <strong>reverse process</strong>, however, is intractable. Using variational inference allows the model to <strong>approximate the reverse process</strong>, and by maximizing the ELBO, it becomes better at denoising, generating samples that are close to the original data distribution. This is critical for high-quality image or data generation in diffusion models.</p></li>
</ul>
</section>
</section>
<section id="monte-carlo-sampling">
<span id="chapter0-8"></span><h2>8. <strong>Monte Carlo Sampling</strong><a class="headerlink" href="#monte-carlo-sampling" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p><strong>Monte Carlo Sampling</strong> is a numerical method used to estimate expectations of functions or integrals when direct computation is infeasible. In the context of diffusion models, Monte Carlo methods allow for the approximation of various quantities, such as expectations over complex distributions, by drawing random samples from these distributions.</p></li>
</ul>
<section id="estimating-expectations">
<h3>Estimating Expectations:<a class="headerlink" href="#estimating-expectations" title="Link to this heading">#</a></h3>
<ul>
<li><p>In many cases, the exact expectation <span class="math notranslate nohighlight">\(\mathbb{E}[f(x)]\)</span> under some probability distribution <span class="math notranslate nohighlight">\(p(x)\)</span> is difficult to compute analytically. Instead, Monte Carlo methods estimate this expectation by drawing samples <span class="math notranslate nohighlight">\(x_1, x_2, \dots, x_N\)</span> from the distribution <span class="math notranslate nohighlight">\(p(x)\)</span>, and using the empirical average:</p>
<div class="math notranslate nohighlight">
\[\mathbb{E}[f(x)] \approx \frac{1}{N} \sum_{i=1}^{N} f(x_i),\]</div>
<p>where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(f(x)\)</span>: A function whose expectation you want to compute.</p></li>
<li><p><span class="math notranslate nohighlight">\(N\)</span>: The total number of samples drawn.</p></li>
<li><p><span class="math notranslate nohighlight">\(x_i\)</span>: Samples drawn from the distribution <span class="math notranslate nohighlight">\(p(x)\)</span>.</p></li>
</ul>
</li>
<li><p>In diffusion models, during training (<strong>forward process</strong>), random noise is added to the data at each time step <span class="math notranslate nohighlight">\(t\)</span>, typically sampled from a Gaussian distribution. Monte Carlo Sampling can be used to approximate how this noise impacts the data; Monte Carlo Sampling can be employed to approximate the <strong>reverse process</strong> by drawing samples from the variational posterior <span class="math notranslate nohighlight">\(q(x_{1:T} | x_0)\)</span>, especially when computing the expectation over possible latent variables or noisy data.</p></li>
</ul>
</section>
</section>
<section id="remarks">
<span id="chapter0-9"></span><h2>9. Remarks<a class="headerlink" href="#remarks" title="Link to this heading">#</a></h2>
<p>Notice that all the terminologies above are brief and at a introductory level, and are by no means rigorous definitions. If you want to know more about them, please refer to the <strong>Wikipedia page</strong> of those concepts. Cheers!</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="intro.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Diffusion Models For Statistics</p>
      </div>
    </a>
    <a class="right-next"
       href="chapter1.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Chapter 1: Non-equilibrium Thermodynamics</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#probability-distributions">1. <strong>Probability Distributions</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#markov-chains">2. <strong>Markov Chains</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#key-properties">Key Properties:</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#diffusion-process">3. <strong>Diffusion Process</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#score-matching">4. <strong>Score Matching</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#stochastic-processes">5. <strong>Stochastic Processes</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#wiener-process">Wiener Process:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ito-calculus">Ito Calculus:</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#kl-divergence">6. <strong>KL Divergence</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#variational-inference">7. <strong>Variational Inference</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#evidence-lower-bound-elbo">Evidence Lower Bound (ELBO):</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#breakdown-of-the-elbo">Breakdown of the ELBO:</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#monte-carlo-sampling">8. <strong>Monte Carlo Sampling</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#estimating-expectations">Estimating Expectations:</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#remarks">9. Remarks</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Yue Yu
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>